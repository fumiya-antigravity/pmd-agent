<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="PdMã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ - Whyã¨Whatã®æ·±æ˜ã‚Šã«ç‰¹åŒ–ã—ãŸè¦ä»¶å®šç¾©æ”¯æ´AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ">
    <title>PdM Assistant v2</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/public/styles.css?v=20260219a">
    <style>
        /* Slider UI */
        .slider-form {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px;
            margin-top: 12px;
            animation: fadeIn 0.3s ease;
        }

        .slider-item {
            margin-bottom: 20px;
        }

        .slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 0.95em;
            color: var(--text);
        }

        .slider-label {
            font-weight: 500;
        }

        .slider-value {
            color: var(--accent);
            font-weight: bold;
            font-family: monospace;
            background: rgba(var(--accent-rgb), 0.1);
            padding: 2px 6px;
            border-radius: 4px;
        }

        .slider-input {
            width: 100%;
            -webkit-appearance: none;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            outline: none;
            cursor: pointer;
        }

        .slider-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--accent);
            border: 2px solid #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.1s, background 0.2s;
        }

        .slider-input::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            background: var(--accent-hover);
        }

        .slider-submit {
            width: 100%;
            padding: 12px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
        }

        .slider-submit:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .slider-submit:active {
            transform: translateY(0);
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
</head>

<body>
    <div class="app-shell">

        <!-- ============================================
             ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆéè¡¨ç¤ºãƒ»Geminié¢¨ï¼‰
             ============================================ -->
        <aside class="sidebar collapsed" id="sidebar">
            <div class="sidebar-header">
                <span class="sidebar-logo">ğŸ’ PdM</span>
                <button id="new-thread-btn" class="sidebar-new-btn">ï¼‹ æ–°è¦</button>
            </div>
            <div class="sidebar-threads" id="sidebar-threads"></div>
        </aside>

        <!-- ============================================
             ãƒ¡ã‚¤ãƒ³ã‚«ãƒ©ãƒ 
             ============================================ -->
        <div class="main-col">

            <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆæœ€å°é™ï¼‰ -->
            <header class="top-bar">
                <div class="top-bar-left">
                    <button id="sidebar-toggle" class="icon-btn" title="ã‚¹ãƒ¬ãƒƒãƒ‰ä¸€è¦§">â˜°</button>
                    <span class="top-bar-title" id="top-bar-title">ğŸ’ PdM Assistant</span>
                </div>
                <div class="phase-dots" id="phase-dots">
                    <span class="dot active" data-phase="INPUT"></span>
                    <span class="dot" data-phase="WHY_SESSION"></span>
                    <span class="dot" data-phase="WHAT_SESSION"></span>
                    <span class="dot" data-phase="APPROACH_SESSION"></span>
                </div>
                <div class="top-bar-right">
                    <button id="preview-btn" class="text-btn">ğŸ“„ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                </div>
            </header>

            <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ -->
            <div class="content-area" id="content-area">

                <!-- Phase: åˆå›å…¥åŠ›ï¼ˆãƒ•ãƒ«ã‚»ãƒ³ã‚¿ãƒ¼ï¼‰ -->
                <div class="welcome-view" id="welcome-view">
                    <div class="welcome-inner">
                        <h1 class="welcome-title">ğŸ’ ä½•ã‚’ä½œã‚ŠãŸã„ã§ã™ã‹ï¼Ÿ</h1>
                        <p class="welcome-sub">æ€ã„ã¤ãã¾ã¾æ›¸ã„ã¦ã¿ã¦ãã ã•ã„ã€‚AIãŒå£æ‰“ã¡ç›¸æ‰‹ã«ãªã‚Šã¾ã™ã€‚</p>
                        <div class="welcome-form">
                            <div class="wf-group">
                                <label class="wf-label"><span class="wf-num">1</span> æ¦‚è¦</label>
                                <textarea id="overview-input" class="wf-textarea" rows="2"
                                    placeholder="ä¾‹: ã‚¸ãƒ¥ãƒ‹ã‚¢PdMãŒç°¡å˜ã«è¦ä»¶å®šç¾©æ›¸ã‚’ä½œã‚Œã‚‹AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ"></textarea>
                            </div>
                            <div class="wf-group">
                                <label class="wf-label"><span class="wf-num">2</span> ãªãœã‚„ã‚ŠãŸã„ï¼Ÿ</label>
                                <textarea id="why-input" class="wf-textarea" rows="3"
                                    placeholder="ä¾‹: è¦ä»¶å®šç¾©ã®æ›¸ãæ–¹ãŒäººã«ã‚ˆã£ã¦ãƒãƒ©ãƒãƒ©ã§ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«æ¯å›æ™‚é–“ãŒã‹ã‹ã£ã¦ã„ã‚‹"></textarea>
                            </div>
                            <button id="start-btn" class="primary-btn lg" disabled>ğŸš€ å£æ‰“ã¡ã‚’é–‹å§‹ã™ã‚‹</button>
                        </div>
                    </div>
                </div>

                <!-- Phase: ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸­ (ãƒãƒ£ãƒƒãƒˆ + å³ãƒ‘ãƒãƒ«) -->
                <div class="session-view hidden" id="session-view">

                    <!-- ãƒãƒ£ãƒƒãƒˆã‚¨ãƒªã‚¢ï¼ˆãƒ¡ã‚¤ãƒ³ï¼‰ -->
                    <div class="chat-col">
                        <div class="chat-scroll" id="chat-scroll">
                            <div class="chat-messages" id="chat-messages"></div>
                        </div>
                        <div class="chat-bar">
                            <textarea id="chat-input" class="chat-input" rows="1" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..."
                                disabled></textarea>
                            <button id="chat-send" class="send-btn" disabled>â†‘</button>
                        </div>
                    </div>

                    <!-- å³ãƒ‘ãƒãƒ«: é€²æ—ãƒãƒƒãƒ—ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹å¾Œã‚¹ãƒ©ã‚¤ãƒ‰ã‚¤ãƒ³ï¼‰ -->
                    <aside class="right-panel" id="right-panel">
                        <div class="rp-header">
                            <span class="rp-title">ğŸ“‹ é€²æ—ãƒãƒƒãƒ—</span>
                        </div>
                        <div class="rp-scroll">
                            <div class="progress-bar-wrap">
                                <div class="progress-fill" id="progress-fill"></div>
                            </div>
                            <span class="progress-text" id="progress-text">0 / 5</span>

                            <div id="aspect-list" class="aspect-list"></div>

                            <!-- What (locked) -->
                            <div class="rp-step locked hidden" id="step-what">
                                <div class="rp-step-head"><span class="rp-badge">STEP 3</span> What ğŸ”’</div>
                                <div class="rp-step-body">
                                    <div class="mini-field"><label>ğŸ’¡ ä¾¡å€¤</label><textarea class="mini-ta what-field"
                                            data-key="value" rows="2" disabled placeholder="Whyç¢ºå®šå¾Œ"></textarea></div>
                                    <div class="mini-field"><label>ğŸ“ ã‚¹ã‚³ãƒ¼ãƒ—</label><textarea class="mini-ta what-field"
                                            data-key="scope" rows="2" disabled placeholder="Whyç¢ºå®šå¾Œ"></textarea></div>
                                    <div class="mini-field"><label>ğŸ“Š æŒ‡æ¨™</label><textarea class="mini-ta what-field"
                                            data-key="success" rows="2" disabled placeholder="Whyç¢ºå®šå¾Œ"></textarea></div>
                                </div>
                            </div>

                            <!-- Approach (locked) -->
                            <div class="rp-step locked hidden" id="step-approach">
                                <div class="rp-step-head"><span class="rp-badge">STEP 4</span> æ–¹é‡ ğŸ”’</div>
                                <div class="rp-step-body">
                                    <div id="approach-table-container" class="hidden"></div>
                                    <div id="approach-selection" class="hidden">
                                        <label>é¸å®šç†ç”±</label>
                                        <textarea id="approach-reason" class="mini-ta" rows="3"
                                            placeholder="ãªãœã“ã®æ–¹é‡ï¼Ÿ"></textarea>
                                        <div class="char-ct"><span id="approach-reason-count">0</span>/100</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
                        <div class="rp-actions">
                            <button id="check-btn" class="primary-btn accent hidden">ğŸ” è¦³ç‚¹ã‚’ãƒã‚§ãƒƒã‚¯</button>
                            <button id="submit-what-btn" class="primary-btn hidden">ğŸ“¤ Whatã‚’å£æ‰“ã¡</button>
                            <button id="brainstorm-btn" class="primary-btn hidden">ğŸ’¡ æ–¹é‡ã‚’æ´—ã„å‡ºã™</button>
                            <button id="finalize-btn" class="primary-btn success hidden">ğŸ¯ æ–¹é‡ã‚’ç¢ºå®š</button>
                        </div>
                    </aside>
                </div>
            </div>
        </div>
    </div>

    <!-- Preview Modal -->
    <div class="modal-overlay hidden" id="preview-modal">
        <div class="modal-card">
            <div class="modal-head">
                <h3>ğŸ“„ è¦ä»¶å®šç¾©æ›¸ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h3>
                <button class="icon-btn modal-close" data-modal="preview-modal">âœ•</button>
            </div>
            <div class="modal-body" id="preview-content"></div>
        </div>
    </div>


    <script src="/src/supabase-client.js?v=20260219a"></script>

    <!-- AI Prompts -->
    <script src="/src/ai/prompts/intent.js?v=20260219a"></script>
    <script src="/src/ai/prompts/interviewer.js?v=20260219a"></script>
    <!-- AI Crews -->
    <script src="/src/ai/crews/intent.js?v=20260219a"></script>
    <script src="/src/ai/crews/interviewer.js?v=20260219a"></script>
    <!-- Pipeline v7: Planner + Interviewer -->
    <script src="/src/ai/crews/pipeline.js?v=20260219a"></script>
    <script src="/src/app.js?v=20260219a"></script>
</body>

</html>